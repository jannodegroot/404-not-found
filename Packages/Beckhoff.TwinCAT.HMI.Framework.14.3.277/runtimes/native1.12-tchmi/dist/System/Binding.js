var __runInitializers=this&&this.__runInitializers||function(thisArg,initializers,value){for(var useValue=arguments.length>2,i=0;i<initializers.length;i++)value=useValue?initializers[i].call(thisArg,value):initializers[i].call(thisArg);return useValue?value:void 0},__esDecorate=this&&this.__esDecorate||function(ctor,descriptorIn,decorators,contextIn,initializers,extraInitializers){function accept(f){if(void 0!==f&&"function"!=typeof f)throw new TypeError("Function expected");return f}for(var _,kind=contextIn.kind,key="getter"===kind?"get":"setter"===kind?"set":"value",target=!descriptorIn&&ctor?contextIn.static?ctor:ctor.prototype:null,descriptor=descriptorIn||(target?Object.getOwnPropertyDescriptor(target,contextIn.name):{}),done=!1,i=decorators.length-1;i>=0;i--){var context={};for(var p in contextIn)context[p]="access"===p?{}:contextIn[p];for(var p in contextIn.access)context.access[p]=contextIn.access[p];context.addInitializer=function(f){if(done)throw new TypeError("Cannot add initializers after decoration has completed");extraInitializers.push(accept(f||null))};var result=(0,decorators[i])("accessor"===kind?{get:descriptor.get,set:descriptor.set}:descriptor[key],context);if("accessor"===kind){if(void 0===result)continue;if(null===result||"object"!=typeof result)throw new TypeError("Object expected");(_=accept(result.get))&&(descriptor.get=_),(_=accept(result.set))&&(descriptor.set=_),(_=accept(result.init))&&initializers.unshift(_)}else(_=accept(result))&&("field"===kind?initializers.unshift(_):descriptor[key]=_)}target&&Object.defineProperty(target,contextIn.name,descriptor),done=!0};import{ControlAttributeType}from"./_Types.js";import{bindingManager}from"./BindingManager.js";import{controlManager}from"./ControlManager.js";import{compareISO8601ServerCommandDateTimeStrings,compareISO8601ServerCommandDurationStrings}from"./SystemFunctions.js";import{typeManager}from"./Type.TypeManager.js";import{Symbol as SystemSymbol}from"./Symbol.js";import{config,Data,isPreloaded}from"./System.js";import*as Server from"../API/Server.js";import*as Log from"../API/Log.js";import*as ValueConverter from"../API/ValueConverter.js";let Binding=(()=>{var _a,_b,_c,_d,_e;let ___onBindingEvent_decorators,___onPropertyChanged_decorators,___onWatchExpressionCallback_decorators,___onWatchCallback_decorators,___onReadCallback_decorators,_classSuper=TcHmi.Destroyable,_instanceExtraInitializers=[];return class Binding extends _classSuper{static{const _metadata="function"==typeof Symbol&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;___onBindingEvent_decorators=[(_a=TcHmi).CallbackMethod.bind(_a)],___onPropertyChanged_decorators=[(_b=TcHmi).CallbackMethod.bind(_b)],___onWatchExpressionCallback_decorators=[(_c=TcHmi).CallbackMethod.bind(_c)],___onWatchCallback_decorators=[(_d=TcHmi).CallbackMethod.bind(_d)],___onReadCallback_decorators=[(_e=TcHmi).CallbackMethod.bind(_e)],__esDecorate(this,null,___onBindingEvent_decorators,{kind:"method",name:"__onBindingEvent",static:!1,private:!1,access:{has:obj=>"__onBindingEvent"in obj,get:obj=>obj.__onBindingEvent},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onPropertyChanged_decorators,{kind:"method",name:"__onPropertyChanged",static:!1,private:!1,access:{has:obj=>"__onPropertyChanged"in obj,get:obj=>obj.__onPropertyChanged},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onWatchExpressionCallback_decorators,{kind:"method",name:"__onWatchExpressionCallback",static:!1,private:!1,access:{has:obj=>"__onWatchExpressionCallback"in obj,get:obj=>obj.__onWatchExpressionCallback},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onWatchCallback_decorators,{kind:"method",name:"__onWatchCallback",static:!1,private:!1,access:{has:obj=>"__onWatchCallback"in obj,get:obj=>obj.__onWatchCallback},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,___onReadCallback_decorators,{kind:"method",name:"__onReadCallback",static:!1,private:!1,access:{has:obj=>"__onReadCallback"in obj,get:obj=>obj.__onReadCallback},metadata:_metadata},null,_instanceExtraInitializers),_metadata&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}static __compareTiming(a,b){return null===Server.getApiVersion()?compareISO8601ServerCommandDateTimeStrings(a,b):compareISO8601ServerCommandDurationStrings(a,b)}constructor(expression,propertyName,control,options){if(super(),(TCHMI_CONSOLE_LOG_LEVEL>=4||TCHMI_PERSISTENT_LOG_LEVEL>=4)&&(this.__diagGUID=tchmi_create_guid()),Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor called with:",{expression,propertyName,control}),!expression){let message='Invalid value: "'+expression+'" for parameter: "expression".';throw Log.debug("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new Error(message)}if(!propertyName){let message='Invalid value: "'+propertyName+'" for parameter: "propertyName".';throw Log.debug("[Source=Framework, ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new Error(message)}if(!control)throw Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+'] constructor failed with invalid value "',control,'" for parameter: "control".'),new Error('Invalid value: "'+control+'" for parameter: "control".');this.__expression=expression,this.__propertyName=propertyName,this.__control=control,this.__stateOld=this.__state,this.__state=State.Initializing,this.__preload=!1,this.__partial=null,this.__symbol=new SystemSymbol({expression,ctx:options?.ctx??void 0}),this.__symbol.claimDestroyPrivilege();let attr=controlManager.getAttributeByPropertyName(this.__control,this.__propertyName);if(!attr){let message='The attribute property name: "'+this.__propertyName+'" does not exist for control: '+control.getId();throw Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+control?.getId()+", Property="+propertyName+", Symbol="+expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] constructor failed with: "+message),new Error(message)}this.__attr=attr,this.__attrSchema=typeManager.getSchema(this.__attr.type);let parent=this.__control.getParent();for(;null!==parent;){let parentType=parent.getType();if(("TcHmi.Controls.System.TcHmiView"===parentType||"TcHmi.Controls.System.TcHmiContent"===parentType||"TcHmi.Controls.System.TcHmiUserControl"===parentType)&&(this.__partial||(this.__partial=parent),"TcHmi.Controls.System.TcHmiView"===parentType||"TcHmi.Controls.System.TcHmiContent"===parentType)){let partialUrl=tchmi_path(parent.getElement()[0].getAttribute("data-tchmi-partial-url"));if(partialUrl&&!0===Data.isPreloadBindingPartial.get(partialUrl)){this.__preload=!0;break}}parent=parent.getParent()}this.__partial?this.__onInitializedDestroyCallback=TcHmi.EventProvider.register(this.__partial.getId()+".System.onInitialized",()=>{this.__resume({reason:this.__partial?.getId()+".onInitialized>BindingResume>"+this.__expression})}):this.__onInitializedDestroyCallback=TcHmi.EventProvider.register(this.__control.getId()+".System.onInitialized",()=>{this.__resume({reason:this.__control?.getId()+".onInitialized>BindingResume>"+this.__expression})}),this.__onControlAttachedDestroyCallback=TcHmi.EventProvider.register(this.__control.getId()+".System.onAttached",()=>{this.__resume({reason:this.__control?.getId()+".onAttached>BindingResume>"+this.__expression})}),this.__onControlDetachedDestroyCallback=TcHmi.EventProvider.register(this.__control.getId()+".System.onDetached",()=>{this.__suspend()}),this.__stateWatcher=new Set,this.__attr.allowEarlySymbolReferenceInjection&&this.__resume()}__diagGUID=(__runInitializers(this,_instanceExtraInitializers),"");__stateOld=State.Invalid;__stateWatcher;__attr;__attrSchema;__lockWriteToControl=!1;__lockWriteToControlValue;__lockWatchError=!1;__lockLastWriteError=!1;__lastReportedError;__pendingWriteCount=0;__latestWrite=!1;__latestWriteProcessedStart;__latestWriteProcessedEnd;__forwardWriteToSymbolResponse=!1;__pendingForceReadRequestId=null;__resumeLock=!1;__resumeStage=0;__destroyWatchExpression=null;__destroyWatch=null;__destroyRead=null;__destroyWrite=new Set;__destroyHostPreloadingBindingsWatch=null;__destroyReferenceWatch=null;__referenceWatchSymbol=null;destroy(){if(this.isDestroyed())return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, ObjectScopeDiagGUID="+this.__diagGUID+"] destroy called and aborted because object is already marked as destroyed.");if(this.__releaseDestroyPrivilege(),!this.isDestroyable())return;let diagControlId=this.__control?.getId(),diagPropertyName=this.__propertyName,diagSymbolExpression=this.__symbol?.getExpression().toString();Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+diagControlId+", Property="+diagPropertyName+", Symbol="+diagSymbolExpression+", ObjectScopeDiagGUID="+this.__diagGUID+"] destroy called."),this.__control=null,this.__destroyReferenceWatch?.(),this.__destroyReferenceWatch=null,this.__destroyRead?.(),this.__destroyRead=null;for(const destr of this.__destroyWrite)destr();if(this.__destroyWrite.clear(),this.__destroyWatchExpression?.(),this.__destroyWatchExpression=null,this.__destroyWatch?.(),this.__destroyWatch=null,this.__symbol?.destroy(),this.__symbol=null,this.__destroyHostPreloadingBindingsWatch?.(),this.__destroyHostPreloadingBindingsWatch=null,this.__onPropertyChangedDestroyCallback?.(),this.__onPropertyChangedDestroyCallback=null,this.__onBindingEventDestroyCallbacks)for(;this.__onBindingEventDestroyCallbacks.length>0;){let onBindingEventDestroyCallback=this.__onBindingEventDestroyCallbacks.shift();onBindingEventDestroyCallback?.(),onBindingEventDestroyCallback=void 0}this.__onInitializedDestroyCallback?.(),this.__onInitializedDestroyCallback=null,this.__onControlAttachedDestroyCallback?.(),this.__onControlAttachedDestroyCallback=null,this.__onControlDetachedDestroyCallback?.(),this.__onControlDetachedDestroyCallback=null,this.__stateOld=this.__state,this.__state=State.Destroyed,this.__procWatchState(),this.__stateWatcher.clear(),Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+diagControlId+", Property="+diagPropertyName+", Symbol="+diagSymbolExpression+", ObjectScopeDiagGUID="+this.__diagGUID+"] destroy finished.")}__resume(args){if(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume called."),isPreloaded||args?.forcePreload)if(this.__resumeLock)Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume aborted. Pending lock.");else if(this.__control)if(this.__symbol){if(0===this.__resumeStage&&(this.__symbol&&"TcHmi.Symbol"===this.__attrSchema?.frameworkInstanceOf?(this.__state===State.Initializing||this.__state===State.Preloading||this.__state===State.Resuming&&this.__stateOld!==State.Initialized)&&(this.__destroyReferenceWatch?.(),this.__destroyReferenceWatch=null,this.__referenceWatchSymbol?.destroy(),this.__referenceWatchSymbol=null,this.__referenceWatchSymbol=new TcHmi.Symbol({expression:this.__symbol.getExpression().toString(),ctx:this.__symbol.getContext()}),this.__referenceWatchSymbol.claimDestroyPrivilege(),this.__destroyReferenceWatch=this.__referenceWatchSymbol.watchReference(data=>{if(data.error!==TcHmi.Errors.NONE){Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] "+Log.buildMessage(data.details));let reset=!1;if("Reset"===config.binding.symbolError?reset=!0:"Ignore"===config.binding.symbolError&&(reset=!1),data.expressionResolved){let options=data.expressionResolved.getOptions();"Reset"===options.BindingErrorHandling?reset=!0:"Ignore"===options.BindingErrorHandling&&(reset=!1)}return reset&&this.__writeToControl(null),this.__stateOld=this.__state,this.__state=State.Error,void this.__procWatchState()}if(this.__state===State.Error){let restoredState=this.__stateOld;this.__stateOld=this.__state,this.__state=restoredState,this.__procWatchState()}let referenceDelegation,ref=data.ref;ref&&(referenceDelegation=ref.getReferenceDelegation(),ref.claimDestroyPrivilege()),this.__writeToControl(ref),this.__stateOld=this.__state,this.__preload&&!isPreloaded?this.__state=State.Preloading:this.__state===State.Preloading?this.__state=State.Initialized:(this.__state===State.Initializing||this.__state===State.Resuming)&&(this.__state=State.Ready),this.__procWatchState(),referenceDelegation&&referenceDelegation.preload&&this.__state===State.Preloading?referenceDelegation.preload(()=>{this.__state!==State.Initialized&&(this.__stateOld=this.__state,this.__state=State.Initialized,this.__procWatchState(),Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume finished."))}):(this.__stateOld=this.__state,this.__state=State.Initialized,this.__procWatchState(),Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume finished."))})):this.__resumeStage=1),1===this.__resumeStage){if(!this.__control.getIsInitialized())return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume aborted. Control is not initialized.");let isAttached=this.__control.getIsAttached();if(this.__state!==State.Initializing&&this.__state!==State.Preloading&&this.__state!==State.Initialized&&this.__state!==State.Suspended&&this.__state!==State.Error||!this.__symbol)return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+'] __resume aborted because binding is neither in state "Initializing", "Initialized" or "Suspended". Current state is '+this.__state);if(this.__state===State.Initialized&&!isAttached)return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+'] __resume aborted because binding is already in state "Initialized" and control is not attached to dom.');if(isAttached)this.__stateOld=this.__state,this.__state=State.Resuming,this.__procWatchState(),Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+'] __resume switches state to "Resuming".');else if(!isPreloaded&&this.__preload&&(this.__stateOld=this.__state,this.__state=State.Preloading,this.__procWatchState(),Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+'] __resume switches state to "Preloading".'),this.__partial&&"TcHmi.Controls.System.TcHmiUserControl"===this.__partial.getType())){const host=this.__partial.getParent();if(host){let hostId=host.getId();this.__resumeLock=!0;const waitForPreloadingBindings=host=>{let preloadingBindings=bindingManager.getPreloadingBindingsByControl(host);if(!(preloadingBindings.size>0))return this.__resumeLock=!1,this.__resumeStage=2,void this.__resume(args);{let preloadingBindingsDone=0;this.__destroyHostPreloadingBindingsWatch=bindingManager.watchPreloadingBindingDoneByControl(host,data=>{if(preloadingBindings.has(data.binding))return preloadingBindingsDone++,preloadingBindingsDone===preloadingBindings.size?(preloadingBindings=bindingManager.getPreloadingBindingsByControl(host),void(0===preloadingBindings.size?(data.destroy?.(),this.__destroyHostPreloadingBindingsWatch&&(this.__destroyHostPreloadingBindingsWatch=null),this.__resumeLock=!1,this.__resumeStage=2,this.__resume(args)):preloadingBindingsDone=0)):void 0})}};return host.getIsInitialized()?void waitForPreloadingBindings(host):void TcHmi.EventProvider.register(hostId+".System.onInitialized",()=>{waitForPreloadingBindings(host)})}}this.__resumeStage=2}if(2===this.__resumeStage){if(this.__resumeStage=0,this.__state===State.Preloading)return void(this.__symbol.isProcessedAsync()?this.__symbol.readEx({forceParallel:!0,forceReadWriteGroup:"TCHMI_BINDING_PRELOAD"},this.__onReadCallback):queueMicrotask(()=>{this.__symbol?.readEx({forceParallel:!0,forceReadWriteGroup:"TCHMI_BINDING_PRELOAD"},this.__onReadCallback)}));if(this.__state===State.Resuming)return this.__propertyName&&(this.__destroyWatchExpression=this.__symbol.watchExpression(this.__onWatchExpressionCallback)),void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume finished.");Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __suspend called.")}}else Log.errorEx("[Source=Framework, Module=TcHmi.System.Binding, Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume aborted. Binding is already destroyed.");else Log.errorEx("[Source=Framework, Module=TcHmi.System.Binding, Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume aborted. Binding is already destroyed.");else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __resume aborted. System is not preloaded and forced preload is not set.")}__suspend(){if(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __suspend called."),this.__destroyWatchExpression&&(this.__destroyWatchExpression(),this.__destroyWatchExpression=null),this.__destroyWatch&&(this.__destroyWatch(),this.__destroyWatch=null),null!==this.__onPropertyChangedDestroyCallback&&(this.__onPropertyChangedDestroyCallback(),this.__onPropertyChangedDestroyCallback=null),this.__onBindingEventDestroyCallbacks)for(;this.__onBindingEventDestroyCallbacks.length>0;){let onBindingEventDestroyCallback=this.__onBindingEventDestroyCallbacks.shift();onBindingEventDestroyCallback?.(),onBindingEventDestroyCallback=void 0}this.__stateOld=this.__state,this.__state=State.Suspended,this.__procWatchState(),Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __suspend finished.")}__expression;getExpression(){return this.__expression}__symbol;getSymbol(){return this.__symbol}__propertyName;getPropertyName(){return this.__propertyName}__control;getControl(){return this.__control}__state=State.Invalid;getState(){return this.__state}__preload;getPreload(){return this.__preload}__partial;getPartial(){return this.__partial}__onInitializedDestroyCallback=null;__onControlAttachedDestroyCallback=null;__onControlDetachedDestroyCallback=null;__onBindingEventDestroyCallbacks=[];__onBindingEvent(){if(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"] __onBindingEvent called."),this.__state===State.Ready){if(!this.__lockWatchError&&this.__control&&void 0!==this.__control[this.__attr.propertyGetterName]){let value=this.__control[this.__attr.propertyGetterName].call(this.__control);if(this.__lockWriteToControl&&tchmi_equal(this.__lockWriteToControlValue,value))return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+'] __onBindingEvent aborted because of "__lockWriteToControl".');this.__writeToSymbol(tchmi_clone_object(value))}}else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+']  __onBindingEvent because Binding is not in state "Ready".')}__onPropertyChangedDestroyCallback=null;__onPropertyChanged(_event,data){if(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __onPropertyChanged"),this.__state===State.Ready)if(data){if(!this.__lockWatchError&&this.__control&&void 0!==this.__control[this.__attr.propertyGetterName]){let value=this.__control[this.__attr.propertyGetterName].call(this.__control);if(this.__lockWriteToControl&&tchmi_equal(this.__lockWriteToControlValue,value))return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+']  __onPropertyChanged aborted because of "__lockWriteToControl".');this.__writeToSymbol(tchmi_clone_object(value),data.dirtyPaths)}}else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+']  __onPropertyChanged aborted because "data" is not defined.');else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+']  __onPropertyChanged aborted because Binding is not in state "Ready".')}__onWatchExpressionCallback(data){let guid="";if(TCHMI_CONSOLE_LOG_LEVEL>=4&&(guid=tchmi_create_guid()),Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__symbol?.getExpression().toString()+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchExpressionCallback called with:",{data}),!this.__control)return;if(data.error!==TcHmi.Errors.NONE){this.__lockWatchError=!0;let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] ";if(data.details?message+=Log.buildMessage(data.details):message+=Log.buildMessage({code:data.error,message:TcHmi.Errors[data.error]}),Log.error(message),this.__lockWriteToControl&&null===this.__lockWriteToControlValue)return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onWatchExpressionCallback aborted because of "__lockWriteToControl".');let reset=!1;if("Reset"===config.binding.symbolError?reset=!0:"Ignore"===config.binding.symbolError&&(reset=!1),data.expressionResolved){let options=data.expressionResolved.getOptions();"Reset"===options.BindingErrorHandling?reset=!0:"Ignore"===options.BindingErrorHandling&&(reset=!1)}return void(reset&&this.__writeToControl(null))}const expression=data.value;if(!expression)return;if(!this.__symbol)return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchExpressionCallback aborted because symbol object is not defined.");if(this.__onPropertyChangedDestroyCallback&&(this.__onPropertyChangedDestroyCallback(),this.__onPropertyChangedDestroyCallback=null),this.__onBindingEventDestroyCallbacks)for(;this.__onBindingEventDestroyCallbacks.length>0;){let onBindingEventDestroyCallback=this.__onBindingEventDestroyCallbacks.shift();onBindingEventDestroyCallback?.(),onBindingEventDestroyCallback=void 0}let bindingMode=expression.getOptions().BindingMode,attrType=controlManager.getAttributeTypeByPropertyName(this.__control,this.__propertyName);if("TwoWay"===bindingMode||!bindingMode&&attrType===ControlAttributeType.UserControlParameter||!bindingMode&&this.__attr&&"TwoWay"===this.__attr.defaultBindingMode){let bindingEvents=expression.getOptions().BindingEvents;if(bindingEvents)for(let i=0,ii=bindingEvents.length;i<ii;i++){let bindingEvent=bindingEvents[i];this.__onBindingEventDestroyCallbacks.push(TcHmi.EventProvider.register(this.__control?.getId()+"."+bindingEvent,this.__onBindingEvent))}else this.__onPropertyChangedDestroyCallback=TcHmi.EventProvider.register(this.__control?.getId()+".onPropertyChanged<"+this.__propertyName+">",this.__onPropertyChanged)}this.__destroyWatch||(this.__destroyWatch=this.__symbol.watchEx(null,this.__onWatchCallback))}__onWatchCallback(data){let guid="";if(TCHMI_CONSOLE_LOG_LEVEL>=4&&(guid=tchmi_create_guid()),Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__symbol?.getExpression().toString()+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback called with:",{data}),null!==this.__pendingForceReadRequestId&&(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback release pending forced read request with id: "+this.__pendingForceReadRequestId),Server.releaseRequest(this.__pendingForceReadRequestId),this.__pendingForceReadRequestId=null),this.__state===State.Ready||this.__state===State.Resuming||this.__state===State.Error)if(this.__symbol)if(data.expressionResolved&&data.expressionResolved.getType()===TcHmi.SymbolType.Server&&this.__lockLastWriteError)Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onWatchCallback aborted because of "__lockLastWriteError".');else{if(data.expressionResolved&&data.expressionResolved.getType()===TcHmi.SymbolType.Server&&this.__pendingWriteCount>0)return Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onWatchCallback aborted because "__pendingWriteCount > 0". "__pendingWriteCount: '+this.__pendingWriteCount),void(this.__forwardWriteToSymbolResponse=!0);if(data.error===TcHmi.Errors.NONE)if(this.__state!==State.Resuming&&this.__state!==State.Error||(this.__stateOld=this.__state,this.__state=State.Ready,this.__procWatchState()),this.__lockWatchError=!1,!TCHMI_DESIGNER&&this.__latestWrite&&data.expressionResolved&&data.expressionResolved.getType()===TcHmi.SymbolType.Server)if(data.processedStart&&data.processedEnd)if(this.__latestWriteProcessedStart&&this.__latestWriteProcessedEnd){let startTimingComparison,endTimingComparison,symbolName=data.expressionResolved.getName(),caughtException=!1;try{startTimingComparison=Binding.__compareTiming(data.processedStart,this.__latestWriteProcessedEnd),endTimingComparison=Binding.__compareTiming(this.__latestWriteProcessedStart,data.processedEnd)}catch(ex){ex instanceof Error&&ex.message!==this.__lastReportedError&&(Log.errorEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback aborted in processed date comparison",ex),this.__lastReportedError=ex.message),caughtException=!0}1===startTimingComparison?(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback calls __writeToControl because watch tick data is newer than last server write."),this.__writeToControl(data.value,data.dirtyPaths)):1===endTimingComparison?Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback aborted because server read has ended before last server write has started. Data is outdated."):symbolName?caughtException||(this.__lastReportedError=void 0,Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback forces read from server because last write and watch callback were processed at roughly the same time."),this.__pendingForceReadRequestId=Server.request({requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:symbolName}]},data=>{if(Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__symbol?.getExpression().toString()+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback forced read finished with:",{data}),this.__pendingForceReadRequestId=null,data.error!==TcHmi.Errors.NONE){let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] ";return data.details?message+=Log.buildMessage(data.details):message+=Log.buildMessage({code:data.error,message:TcHmi.Errors[data.error]}),void Log.error(message)}let response=data.response;if(void 0===response)return void Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] "+Log.buildMessage({code:TcHmi.Errors.E_SERVER_RESPONSE_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.System.Binding"}));if(response&&response.error)return void Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] "+Log.buildMessage({code:TcHmi.Errors.E_SERVER_RESPONSE_ERROR,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: "+response.id,domain:"TcHmi.System.Binding",errors:[response.error]}));let command,commands=response.commands;if(!commands)return void Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] Server responds with error: "+Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMANDS_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: "+response.id,domain:"TcHmi.System.Symbol"}));for(let i=0,ii=commands.length;i<ii;i++){let command2=commands[i];if(command2&&command2.symbol===symbolName){command=command2;break}}if(!command)return void Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] Server responds with error: "+Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMAND_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMAND_MISSING],reason:'Missing command for symbol: "'+symbolName+'" in response from server with id: '+response.id,domain:"TcHmi.System.Symbol"}));if(command.error)return void Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] Server responds with error: "+Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMAND_ERROR,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMAND_ERROR],reason:'Error in command for symbol: "'+symbolName+'" in response from server with id: '+response.id,domain:"TcHmi.System.Symbol",errors:[command.error]}));if(void 0===command.readValue)return void Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] Server responds with error: "+Log.buildMessage({code:TcHmi.Errors.E_SERVER_READVALUE_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_READVALUE_MISSING],reason:'Missing property: "readValue" in command for symbol: "'+symbolName+'" in response from server with id: '+response.id,domain:"TcHmi.System.Symbol"}));let value=command.readValue;this.__lockWriteToControl&&tchmi_equal(this.__lockWriteToControlValue,value)?Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onWatchCallback aborted because of "__lockWriteToControl".'):(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback calls __writeToControl with forced read data."),this.__writeToControl(value))})):Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback aborted: Symbol Expression is not valid.")}else Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+'] Missing property "processedStart" or "processedEnd" in response.');else Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+'] Missing property "processedStart" or "processedEnd" in response.');else{let value=data.value;if(this.__lockWriteToControl&&tchmi_equal(this.__lockWriteToControlValue,value))return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onWatchCallback aborted because of "__lockWriteToControl".');this.__writeToControl(value,data.dirtyPaths)}else{this.__lockWatchError=!0;let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] ";if(data.details?message+=Log.buildMessage(data.details):message+=Log.buildMessage({code:data.error,message:TcHmi.Errors[data.error]}),Log.error(message),this.__lockWriteToControl&&null===this.__lockWriteToControlValue)return void Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onWatchCallback aborted because of "__lockWriteToControl".');let reset=!1;if("Reset"===config.binding.symbolError?reset=!0:"Ignore"===config.binding.symbolError&&(reset=!1),data.expressionResolved){let options=data.expressionResolved.getOptions();"Reset"===options.BindingErrorHandling?reset=!0:"Ignore"===options.BindingErrorHandling&&(reset=!1)}reset&&this.__writeToControl(null),this.__stateOld=this.__state,this.__state=State.Error,this.__procWatchState()}}else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onWatchCallback aborted because symbol object is not defined.");else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onWatchCallback aborted because state is neither "Ready", "Resuming" or "Error".')}__onReadCallback(data){let guid="";if(TCHMI_CONSOLE_LOG_LEVEL>=4&&(guid=tchmi_create_guid()),Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__symbol?.getExpression().toString()+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onReadCallback called with:",{data}),this.__state===State.Preloading)if(this.__symbol){if(data.error!==TcHmi.Errors.NONE){let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] ";data.details?message+=Log.buildMessage(data.details):message+=Log.buildMessage({code:data.error,message:TcHmi.Errors[data.error]}),Log.error(message)}if(data.error!==TcHmi.Errors.NONE)return"Reset"===config.binding.symbolError&&this.__writeToControl(null),this.__stateOld=this.__state,this.__state=State.Error,void this.__procWatchState();this.__writeToControl(data.value,data.dirtyPaths),this.__stateOld=this.__state,this.__state=State.Initialized,this.__procWatchState()}else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"] __onReadCallback aborted because symbol object is not defined.");else Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+'] __onReadCallback aborted because state is not "Reading".')}__writeToSymbol(value,dirtyPaths){if(null===dirtyPaths&&(dirtyPaths=void 0),void 0===value)return;if(!this.__symbol)return;let guid="";TCHMI_CONSOLE_LOG_LEVEL>=4&&(guid=tchmi_create_guid()),Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__symbol?.getExpression().toString()+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+"]  __writeToSymbol called with:",{value,dirtyPaths}),null!==this.__pendingForceReadRequestId&&(Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+']  __writeToSymbol release pending forced read request with id: "'+this.__pendingForceReadRequestId),Server.releaseRequest(this.__pendingForceReadRequestId),this.__pendingForceReadRequestId=null,this.__forwardWriteToSymbolResponse=!0),this.__pendingWriteCount++;let syncCb=!1;const destroyWrite=this.__symbol.writeEx(value,dirtyPaths,data=>{if(syncCb=!0,this.__symbol&&this.__state!==State.Destroyed)if(data.error===TcHmi.Errors.NONE)this.__pendingWriteCount--,this.__symbol.getExpression().getType()===TcHmi.SymbolType.Server&&(this.__latestWrite=!0,data.processedStart&&data.processedEnd?(this.__latestWriteProcessedStart=data.processedStart,this.__latestWriteProcessedEnd=data.processedEnd):(Log.error("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+'] Missing property "processedStart" or "processedEnd" in response.'),this.__lockLastWriteError=!0),!this.__lockLastWriteError&&0===this.__pendingWriteCount&&this.__forwardWriteToSymbolResponse?(this.__writeToControl(data.value,dirtyPaths),this.__forwardWriteToSymbolResponse=!1):this.__lockLastWriteError?Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+']  __writeToSymbol aborted because of "__lockLastWriteError".'):this.__pendingWriteCount>0?Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+']  __writeToSymbol aborted because "__pendingWriteCount > 0". __pendingWriteCount: '+this.__pendingWriteCount):this.__forwardWriteToSymbolResponse||Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+", FunctionScopeGuid="+guid+']  __writeToSymbol aborted because "__forwardWriteToSymbolResponse === false".'));else{let message="[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] ";data.details?message+=Log.buildMessage(data.details):message+=Log.buildMessage({code:data.error,message:TcHmi.Errors[data.error]}),Log.error(message);let readBack=!0;if(data.expressionResolved){"Ignore"===data.expressionResolved.getOptions().BindingWriteErrorHandling&&(readBack=!1)}readBack?this.__symbol?.read(data=>{this.__pendingWriteCount--,data.error===TcHmi.Errors.NONE&&this.__writeToControl(data.value)}):this.__pendingWriteCount--}});!syncCb&&destroyWrite&&this.__destroyWrite.add(destroyWrite)}__writeToControl(value,dirtyPaths){if(null===dirtyPaths&&(dirtyPaths=void 0),Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__symbol?.getExpression().toString()+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __writeToControl called with:",{value,dirtyPaths}),void 0===value)return;if(!this.__control)return;const preDetached=this.__partial?.getLifeCycleState().detaching;if(preDetached)return void(-1===TCHMI_CONSOLE_LOG_LEVEL&&performance.mark("System.Binding: Skipped binding write to predetached "+this.__control?.getId(),{detail:{control:this.__control?.getId(),partial:this.__partial?.getId()}}));let error;this.__lockWriteToControl=!0,this.__lockWriteToControlValue=ValueConverter.toType(tchmi_clone_object(value),this.__attr.type);try{Log.debug("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __writeToControl calling attribute setter."),error=controlManager.setControlPropertyByAttribute(this.__control,this.__attr,tchmi_clone_object(value),dirtyPaths),Log.debugEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__symbol?.getExpression().toString()+", ObjectScopeDiagGUID="+this.__diagGUID+"]  __writeToControl calling attribute finished with:",{error})}catch(e){Log.errorEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] An uncaught exception occurred in setter function of attribute with propertyName="+this.__propertyName+" of control="+this.__control?.getId()+":\n",e)}finally{this.__lockWriteToControl=!1,this.__lockWriteToControlValue=void 0}error&&error.code!==TcHmi.Errors.NONE&&(error.exception?Log.errorEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] "+Log.buildMessage(error),"\n",error.exception):Log.errorEx("[Source=Framework, Module=TcHmi.System.Binding, Control="+this.__control?.getId()+", Property="+this.__propertyName+", Symbol="+this.__expression+"] "+Log.buildMessage(error)))}__procWatchState(){for(const stateWatcher of this.__stateWatcher.keys())TcHmi.Callback.callSafeEx(stateWatcher.callback,this,{error:TcHmi.Errors.NONE,binding:this,state:this.__state,stateOld:this.__stateOld,destroy:stateWatcher.destroy})}watchState(callback){const destroy=()=>{watcher&&this.__stateWatcher.delete(watcher)},watcher={callback,destroy};return this.__stateWatcher.add(watcher),TcHmi.Callback.callSafeEx(callback,this,{error:TcHmi.Errors.NONE,binding:this,state:this.__state,stateOld:this.__stateOld,destroy}),destroy}}})();export{Binding};export var State;!function(State){State[State.Invalid=0]="Invalid",State[State.Error=1]="Error",State[State.Initializing=100]="Initializing",State[State.Resuming=200]="Resuming",State[State.Preloading=300]="Preloading",State[State.Initialized=400]="Initialized",State[State.Ready=500]="Ready",State[State.Suspended=600]="Suspended",State[State.Destroyed=700]="Destroyed"}(State||(State={}));